<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel-Degrees</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
    <style>
        /* Basic styles for the table */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        td[contentEditable="true"]:focus {
            outline: 2px solid #007BFF; /* Blue outline on focus */
        }

        /* Button Styles */
        .controls button, .controls input[type="color"], .controls select {
            background-color: #007BFF;
            color: white;
            padding: 8px 12px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        .controls button:hover {
            background-color: #0056b3;
        }
        .controls input[type="color"] {
            padding: 4px;
            cursor: pointer;
        }
        .controls select {
            padding: 4px;
        }

        /* Dark mode styles */
        body.dark-mode {
            background-color: #121212;
            color: #ffffff;
        }
        .dark-mode th {
            background-color: #1e1e1e;
            color: #ffffff;
        }
        .dark-mode td {
            background-color: #1e1e1e;
            color: #ffffff;
            border-color: #444;
        }
        .dark-mode .controls button {
            background-color: #333;
            color: #ffffff;
            border: 1px solid #555;
        }
    </style>
</head>
<body>
    <h3>كشف الدرجات</h3>

    <!-- University Name Section -->
    <div class="university-container" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
        <div id="universityNameEn" style="font-weight: 600;">Jazan University</div>
        <div id="universityNameAr" style="direction: rtl; font-weight: 600;">جامعة جازان</div>
    </div>

    <!-- Date Section -->
    <div class="date-container" style="display: flex; justify-content: space-between; align-items: center;">
        <div id="englishDate" style="font-weight: 600;"></div>
        <div id="arabicDate" style="direction: rtl; font-weight: 600;"></div>
    </div>

    <!-- Logo Section -->
    <div class="logo-container" style="text-align: center; margin-bottom: 20px;">
        <img src="images/jazan.png" alt="Logo" style="width: 150px; height: auto; border-radius: 50%;" />
    </div>

    <div class="controls">
        <button id="addRow">Add Row Table 1</button>
        <button id="deleteRow" style="background-color:red">Delete Row Table 1</button>
        <button id="addRow2">Add Row Table 2</button>
        <button id="deleteRow2" style="background-color:red">Delete Row Table 2</button>
        <button id="addCol">Add Column Table 1</button>
        <button id="deleteCol" style="background-color:red">Delete Column Table 1</button>
        <button id="addCol2">Add Column Table 2</button>
        <button id="deleteCol2" style="background-color:red">Delete Column  Table 2</button> <!-- Updated label -->
        <button id="bold">Bold</button>
        <button id="italic">Italic</button>
        <label for="bgColorPicker">Background Color:</label>
        <input type="color" id="bgColorPicker">
        <label for="fontColorPicker">Font Color:</label>
        <input type="color" id="fontColorPicker">
        <label for="fontSizePicker">Font Size:</label>
        <select id="fontSizePicker">
            <option value="12px">12</option>
            <option value="14px">14</option>
            <option value="16px">16</option>
            <option value="18px">18</option>
            <option value="20px">20</option>
            <option value="24px">24</option>
            <option value="28px">28</option>
            <option value="32px">32</option>
        </select>
        <button id="toggleDarkMode">Toggle Dark Mode</button>
        <button id="downloadExcel">Download as Excel</button>
    </div>
    
    <table id="excelTable" tabindex="0">
        <thead>
            <tr>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">3</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">:عدد الساعات</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">0</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">:رمز المقرر</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">Main Campus</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">:المقرر</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td contentEditable="true">0</td>
                <td contentEditable="true">:رقم الشعبه</td>
                <td contentEditable="true">0</td>
                <td contentEditable="true">:اسم المقرر</td>
                <td contentEditable="true">College of CS & IT</td>
                <td contentEditable="true">:الكليه</td>
            </tr>
            <tr>
                <td contentEditable="true">بكالريوس</td>
                <td contentEditable="true">:الدرجه</td>
                <td contentEditable="true">0</td>
                <td contentEditable="true">:استاذ المقرر</td>
                <td contentEditable="true">IT & Security</td>
                <td contentEditable="true">:القسم</td>
            </tr>
        </tbody>
    </table>

    <table id="excelTable2" tabindex="0">
        <thead>
            <tr>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">3</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">:عدد الساعات</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">0</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">:رمز المقرر</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">Main Campus</th>
                <th contentEditable="true"><input type="checkbox" class="cell-checkbox">:المقرر</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td contentEditable="true">0</td>
                <td contentEditable="true">:رقم الشعبه</td>
                <td contentEditable="true">0</td>
                <td contentEditable="true">:اسم المقرر</td>
                <td contentEditable="true">College of CS & IT</td>
                <td contentEditable="true">:الكليه</td>
            </tr>
            <tr>
                <td contentEditable="true">بكالريوس</td>
                <td contentEditable="true">:الدرجه</td>
                <td contentEditable="true">0</td>
                <td contentEditable="true">:استاذ المقرر</td>
                <td contentEditable="true">IT & Security</td>
                <td contentEditable="true">:القسم</td>
            </tr>
        </tbody>
    </table>

    <script src="excelscript.js"></script>
    <script>
        // Function to get current date and display it
        function displayDate() {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            const today = new Date();

            // Format English date
            const englishDate = today.toLocaleDateString('en-US', options);
            document.getElementById('englishDate').textContent = englishDate;

            // Format Arabic date
            const arabicDate = today.toLocaleDateString('ar-EG', options);
            document.getElementById('arabicDate').textContent = arabicDate;
        }

        displayDate();

        // Load table data from local storage for both tables
        function loadTableData(tableId) {
            const tableData = JSON.parse(localStorage.getItem(tableId)) || [];
            const tableBody = document.querySelector(`#${tableId} tbody`);
            tableBody.innerHTML = '';

            tableData.forEach(rowData => {
                const row = document.createElement('tr');
                rowData.forEach(cellData => {
                    const cell = document.createElement('td');
                    cell.contentEditable = 'true';
                    cell.textContent = cellData;
                    // Add an input event listener to save data as user types
                    cell.addEventListener('input', () => saveTableData(tableId));
                    row.appendChild(cell);
                });
                tableBody.appendChild(row);
            });
        }

        // Save table data to local storage for both tables
        function saveTableData(tableId) {
            const tableData = [];
            const rows = document.querySelectorAll(`#${tableId} tbody tr`);
            rows.forEach(row => {
                const rowData = Array.from(row.children).map(cell => cell.textContent);
                tableData.push(rowData);
            });
            localStorage.setItem(tableId, JSON.stringify(tableData));
        }

        // Add functionality to add a row for the first table
        document.getElementById('addRow').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable tbody');
            const newRow = document.createElement('tr');
            for (let i = 0; i < 6; i++) {
                const newCell = document.createElement('td');
                newCell.contentEditable = 'true';
                newCell.addEventListener('input', () => saveTableData('excelTable')); // Add listener here
                newRow.appendChild(newCell);
            }
            tableBody.appendChild(newRow);
            saveTableData('excelTable');
        });

        // Add functionality to delete a row for the first table
        document.getElementById('deleteRow').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable tbody');
            const rows = tableBody.querySelectorAll('tr');
            if (rows.length > 0) {
                tableBody.removeChild(rows[rows.length - 1]);
                saveTableData('excelTable');
            }
        });

        // Add functionality to add a row for the second table
        document.getElementById('addRow2').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable2 tbody');
            const newRow = document.createElement('tr');
            for (let i = 0; i < 6; i++) {
                const newCell = document.createElement('td');
                newCell.contentEditable = 'true';
                newCell.addEventListener('input', () => saveTableData('excelTable2')); // Add listener here
                newRow.appendChild(newCell);
            }
            tableBody.appendChild(newRow);
            saveTableData('excelTable2');
        });

        // Add functionality to delete a row for the second table
        document.getElementById('deleteRow2').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable2 tbody');
            const rows = tableBody.querySelectorAll('tr');
            if (rows.length > 0) {
                tableBody.removeChild(rows[rows.length - 1]);
                saveTableData('excelTable2');
            }
        });

        // Add functionality to add a column for the first table
        document.getElementById('addCol').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable tbody');
            const headers = document.querySelectorAll('#excelTable thead th');
            const newHeader = document.createElement('th');
            newHeader.contentEditable = 'true';
            newHeader.textContent = 'New Column';
            headers[0].parentElement.appendChild(newHeader);

            tableBody.querySelectorAll('tr').forEach(row => {
                const newCell = document.createElement('td');
                newCell.contentEditable = 'true';
                newCell.addEventListener('input', () => saveTableData('excelTable')); // Add listener here
                row.appendChild(newCell);
            });
            saveTableData('excelTable');
        });

        // Add functionality to delete a column for the first table
        document.getElementById('deleteCol').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable tbody');
            const headers = document.querySelectorAll('#excelTable thead th');
            if (headers.length > 0) {
                headers[headers.length - 1].remove(); // Remove header
                tableBody.querySelectorAll('tr').forEach(row => {
                    if (row.children.length > 0) {
                        row.removeChild(row.children[row.children.length - 1]); // Remove last cell
                    }
                });
                saveTableData('excelTable');
            }
        });

        // Add functionality to add a column for the second table
        document.getElementById('addCol2').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable2 tbody');
            const headers = document.querySelectorAll('#excelTable2 thead th');
            const newHeader = document.createElement('th');
            newHeader.contentEditable = 'true';
            newHeader.textContent = 'New Column';
            headers[0].parentElement.appendChild(newHeader);

            tableBody.querySelectorAll('tr').forEach(row => {
                const newCell = document.createElement('td');
                newCell.contentEditable = 'true';
                newCell.addEventListener('input', () => saveTableData('excelTable2')); // Add listener here
                row.appendChild(newCell);
            });
            saveTableData('excelTable2');
        });

        // Add functionality to delete a column for the second table
        document.getElementById('deleteCol2').addEventListener('click', function () {
            const tableBody = document.querySelector('#excelTable2 tbody');
            const headers = document.querySelectorAll('#excelTable2 thead th');
            if (headers.length > 0) {
                headers[headers.length - 1].remove(); // Remove header
                tableBody.querySelectorAll('tr').forEach(row => {
                    if (row.children.length > 0) {
                        row.removeChild(row.children[row.children.length - 1]); // Remove last cell
                    }
                });
                saveTableData('excelTable2');
            }
        });

        // Styling options
        document.getElementById('bold').addEventListener('click', function () {
            document.execCommand('bold');
        });
        
        document.getElementById('italic').addEventListener('click', function () {
            document.execCommand('italic');
        });

        document.getElementById('bgColorPicker').addEventListener('input', function () {
            const selectedColor = this.value;
            document.execCommand('backColor', false, selectedColor);
        });

        document.getElementById('fontColorPicker').addEventListener('input', function () {
            const selectedColor = this.value;
            document.execCommand('foreColor', false, selectedColor);
        });

        document.getElementById('fontSizePicker').addEventListener('change', function () {
            const selectedSize = this.value;
            document.execCommand('fontSize', false, '7'); // Set to custom size
            const fontElements = document.getElementsByTagName('font');
            for (let i = 0; i < fontElements.length; i++) {
                fontElements[i].size = '7'; // Apply size '7'
                fontElements[i].style.fontSize = selectedSize; // Apply selected size
            }
        });

        // Dark mode toggle
        document.getElementById('toggleDarkMode').addEventListener('click', function () {
            document.body.classList.toggle('dark-mode');
        });

        // Download functionality for Excel
        document.getElementById('downloadExcel').addEventListener('click', function () {
            const wb = XLSX.utils.table_to_book(document.getElementById('excelTable'));
            XLSX.utils.book_append_sheet(wb, XLSX.utils.table_to_sheet(document.getElementById('excelTable2')), 'Second Table');
            XLSX.writeFile(wb, 'tables.xlsx');
        });

        // Load initial data for both tables
        loadTableData('excelTable');
        loadTableData('excelTable2');
    </script>
</body>
</html>
